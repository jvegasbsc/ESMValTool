documentation:
  description: |
    Independent assessment of extremes of single products for the C3S_511 quality brief

  authors:
    - mueller_benjamin
    - crezee_bas


datasets:
  - {dataset: CDS-SATELLITE-SOIL-MOISTURE, project: OBS, mip: day, tier: 2, type: sat, version: L3S-SSMV-COMBINED-v4.2, start_year: 1979, end_year: 2018}

preprocessors:
  default: &default_pp
    custom_order: True
#    daily_statistics:
#      operator: mean

  Drought-Heat_Europe_2013:
    extract_region:
      end_latitude: 60.0
      end_longitude: 17.0
      start_latitude: 35.0
      start_longitude: 10.0
    <<: *default_pp
  Drought-Heat_Europe_2015:
    extract_region:
      end_latitude: 55.0
      end_longitude: 35.0
      start_latitude: 45.0
      start_longitude: 0.0
    <<: *default_pp
  Drought-Heat_Europe_2018:
    extract_region:
      end_latitude: 68.0
      end_longitude: 35.0
      start_latitude: 45.0
      start_longitude: 10.0
    <<: *default_pp
  Drought-Heat_WRussia_2010:
    extract_region:
      end_latitude: 60.0
      end_longitude: 55.0
      start_latitude: 50.0
      start_longitude: 35.0
    <<: *default_pp
  Drought-Heat_Europe_2003:
    extract_region:
      end_latitude: 53.0
      end_longitude: 20.0
      start_latitude: 42.0
      start_longitude: 0.0
    <<: *default_pp

diagnostics:
  SPQB:
    description: Single product quality brief extremes section.
    variables:
      sm:
        preprocessor: Drought-Heat_Europe_2003 # Specify here the event to be studied
                                               # and define it above as a preprocessor. At each 
                                               # run the list of extreme events is written to
                                               # the work_dir as yaml, it can be copied from 
                                               # there to this recipe.
    scripts:
      SPQB_basic_report:
        script: qualassess/ex_C3S_511_SPQB.py # 
        requests: [custom]                    # ++++++++++ Extreme parameters follow below +++++++
        minimal_number_measurements: 10       # if for a certain gridpoint there are less
                                              # valid data points than specified here
                                              # this gridpoint is masked
        which_percentile: 10                  # per default assuming exceeding extremes 
                                              # for percentiles > 50 and vice versa
        window_size: 5                        # size of the window
                                              # List below the extreme events as in the Google
                                              # Drive document. Note that identifiers 
                                              # of the event refer to the columns 'Event Category', 
                                              # 'Region/Country' and 'Year' joined by '_' and any
                                              # whitespace removed.
        extreme_events: [Drought_MiddleEast_2014, Drought-Heat_Europe_2013, Drought-Heat_Europe_2015, Drought-Heat_Europe_2003]
        multiprocessing: 1                    # the number of cores used
                                              # use 1 for no multiprocessing
                                              # multiprocessing is an experimental functionality
